# SRT翻译Agent配置说明

## 环境变量配置

SRT翻译Agent已优化支持代理提供商，通过环境变量进行配置。

### 代理提供商配置 (推荐)

```bash
# 设置环境变量
export OPENAI_API_KEY=your_api_key_here
export MODEL_BASE_URL=https://your.proxy.com/v1
export MODEL_NAME=gpt-4o-mini
```

### 官方OpenAI API配置

```bash
# 只需要设置API密钥
export OPENAI_API_KEY=sk-your_openai_api_key
# MODEL_BASE_URL和MODEL_NAME使用默认值
```

## 配置参数说明

| 环境变量 | 必需 | 默认值 | 说明 |
|---------|------|--------|------|
| `OPENAI_API_KEY` | ✅ | - | API密钥 |
| `MODEL_BASE_URL` | ⚪ | 官方API | 代理提供商的基础URL |
| `MODEL_NAME` | ⚪ | gpt-4o-mini | 使用的模型名称 |

## 支持的模型

### 代理提供商常见模型
- `gpt-4o-mini` (推荐，性价比高)
- `gpt-3.5-turbo` (经济实惠)
- `gpt-4` (高质量)
- `gpt-4-turbo` (平衡选择)

### 官方OpenAI模型
- `gpt-4o-mini`
- `gpt-3.5-turbo`
- `gpt-4`
- `gpt-4-turbo`

## 使用方法

### 1. 设置环境变量

**Windows (PowerShell):**
```powershell
$env:OPENAI_API_KEY="your_api_key"
$env:MODEL_BASE_URL="https://your.proxy.com/v1"
$env:MODEL_NAME="gpt-4o-mini"
```

**Linux/macOS:**
```bash
export OPENAI_API_KEY=your_api_key
export MODEL_BASE_URL=https://your.proxy.com/v1
export MODEL_NAME=gpt-4o-mini
```

### 2. 验证配置

```bash
uv run python translation_example.py
```

### 3. 使用翻译Agent

```python
from srt_translator_agent import SRTTranslatorAgent

# 自动使用环境变量配置
agent = SRTTranslatorAgent()

# 或者覆盖特定参数
agent = SRTTranslatorAgent(llm_model="gpt-4")
```

## 配置示例

### 示例1: 代理提供商配置
```bash
export OPENAI_API_KEY=sk-1234567890abcdef
export MODEL_BASE_URL=https://api.example.com/v1
export MODEL_NAME=gpt-4o-mini
```

### 示例2: 官方OpenAI配置
```bash
export OPENAI_API_KEY=sk-proj-1234567890abcdef
# 无需设置其他变量
```

## 代码兼容性

代码同时支持：
- 环境变量自动配置 (推荐)
- 手动参数传递 (兼容性)

```python
# 方式1: 环境变量配置 (推荐)
agent = SRTTranslatorAgent()

# 方式2: 手动配置
agent = SRTTranslatorAgent(
    llm_model="gpt-4o-mini",
    api_key="your_key",
    base_url="https://your.proxy.com/v1"
)
```

## 故障排除

### 问题1: API密钥未设置
```
❌ 请设置OPENAI_API_KEY环境变量
```
**解决方案**: 设置环境变量 `OPENAI_API_KEY`

### 问题2: 连接失败
```
❌ 翻译失败: Connection error
```
**解决方案**: 
1. 检查 `MODEL_BASE_URL` 是否正确
2. 确认网络连接正常
3. 验证代理提供商状态

### 问题3: 模型不支持
```
❌ Model not found
```
**解决方案**: 
1. 检查 `MODEL_NAME` 是否正确
2. 确认代理提供商支持该模型
3. 尝试使用 `gpt-4o-mini`

## 安全注意事项

1. ⚠️ **不要**将API密钥硬编码在代码中
2. ⚠️ **不要**将包含API密钥的配置文件提交到版本控制
3. ✅ 使用环境变量管理敏感信息
4. ✅ 定期轮换API密钥 